name: deploy next to ncloud

on:
  # ê¸°ì¡´ push íŠ¸ë¦¬ê±° ìœ ì§€ (í•„ìš”í•˜ë©´ ë‚˜ì¤‘ì— ì œê±° ê°€ëŠ¥)
  push:
    branches: [main]

  # ìˆ˜ë™ ì‹¤í–‰ ì‹œ ì²´í¬ë°•ìŠ¤ë¡œ ë°°í¬ ì—¬ë¶€ë¥¼ ê²°ì •
  workflow_dispatch:
    inputs:
      deploy_ncp:
        description: "ì´ë²ˆ ì‹¤í–‰ì—ì„œ NCP ë°°í¬ë¥¼ ìˆ˜í–‰í• ê¹Œìš”?"
        type: boolean
        default: false

jobs:
  pull_from_registry:
    name: NCP ì ‘ì† í›„ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë° ë°°í¬
    runs-on: ubuntu-latest
    # ğŸ‘‰ ìˆ˜ë™ ì‹¤í–‰(workflow_dispatch) ì´ë©´ì„œ ì²´í¬ë°•ìŠ¤ê°€ trueì¼ ë•Œë§Œ ì‹¤í–‰
    if: ${{ github.event_name == 'workflow_dispatch' && inputs.deploy_ncp == true }}
    steps:
      - name: ssh ì—°ê²°
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.NCP_HOST }}
          key: ${{ secrets.SSH_KEY }}
          username: ${{ secrets.NCP_USERNAME }}
          password: ${{ secrets.NCP_PASSWORD }}
          port: ${{ secrets.NCP_PORT }}
          script: |
            ls -al

